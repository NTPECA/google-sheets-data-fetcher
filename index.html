<!DOCTYPE html>
<html>
<head>
    <title>NTPECA LOAN BALANCE INQUIRY</title>
    <script>
        function loadGapi() {
            const script = document.createElement('script');
            script.src = 'https://apis.google.com/js/api.js';
            script.onload = init;
            script.onerror = function() {
                console.error('Error loading Google API client library.');
                document.getElementById('result').innerText = 'Error loading Google API client library.';
            };
            document.head.appendChild(script);
        }

        function init() {
            gapi.load('client', {
                callback: function() {
                    gapi.client.init({
                        'apiKey': 'AIzaSyDCXbc3M3ZAmIi_FJTSHuC2MVuzSqxJZPY',
                        'discoveryDocs': ['https://sheets.googleapis.com/$discovery/rest?version=v4'],
                    }).then(function() {
                        document.getElementById('searchButton').onclick = searchSheet;
                    }).catch(function(error) {
                        console.error('Error initializing Google API client:', error);
                        document.getElementById('result').innerText = 'Error initializing Google API client.';
                    });
                },
                onerror: function() {
                    console.error('Error loading Google API client library.');
                    document.getElementById('result').innerText = 'Error loading Google API client library.';
                },
                timeout: 5000, // 5 seconds.
                ontimeout: function() {
                    console.error('Google API client library load timeout.');
                    document.getElementById('result').innerText = 'Google API client library load timeout.';
                }
            });
        }

        function searchSheet() {
            const id = document.getElementById('idInput').value;

            gapi.client.sheets.spreadsheets.values.get({
                spreadsheetId: '1ai2njbt8pkT5zk-y82Ek14XqKkLDU_Sgx7eZA1xXQ7w',
                range: 'Sheet1!A:L', // Adjust the range as needed
            }).then(function(response) {
                const rows = response.result.values;
                let result = '<table border="1"><tr><th>ID</th><th>Name</th><th>Long_Term_Bal</th><th>Start</th><th>End</th><th>Guarantor</th></tr><tr><th>Short_Term_Bal</th><th>Start</th><th>End</th><th>Guarantor</th><th>Cutoff</th></tr>';
                rows.forEach(row => {
                    if (row[0] == id) {
                        result += `<tr><td>${row[0]}</td><td>${row[1]}</td><td>${row[2]}</td><td>${row[3]}</td><td>${row[4]}</td><td>${row[5]}</td></tr>`;
                        result += `<tr><td>${row[6]}</td><td>${row[7]}</td><td>${row[8]}</td><td>${row[9]}</td><td>${row[11]}</td></tr>`;
                    '</table>';
                document.getElementById('result').innerHTML = result;
            }).catch(function(error) {
                console.error('Error fetching data from Google Sheets:', error);
                document.getElementById('result').innerText = 'Error fetching data from Google Sheets.';
            });
        }

        window.onload = loadGapi;
    </script>
</head>
<body>
    <h1>NTPECA LOAN BALANCE INQUIRY</h1>
    <input type="text" id="idInput" placeholder="Enter ID">
    <button id="searchButton">Search</button>
    <div id="result"></div>
</body>
</html>
