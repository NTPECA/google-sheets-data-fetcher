<!DOCTYPE html>
<html>
<head>
    <title>Google Sheets Data Fetcher</title>
    <script>
        function loadGapi() {
            const script = document.createElement('script');
            script.src = 'https://apis.google.com/js/api.js';
            script.onload = init;
            script.onerror = function() {
                console.error('Error loading Google API client library.');
                document.getElementById('result').innerText = 'Error loading Google API client library.';
            };
            document.head.appendChild(script);
        }

        function init() {
            gapi.load('client', {
                callback: function() {
                    gapi.client.init({
                        'apiKey': 'AIzaSyDCXbc3M3ZAmIi_FJTSHuC2MVuzSqxJZPY',
                        'discoveryDocs': ['https://sheets.googleapis.com/$discovery/rest?version=v4'],
                    }).then(function() {
                        document.getElementById('searchButton').onclick = searchSheet;
                    }).catch(function(error) {
                        console.error('Error initializing Google API client:', error);
                        document.getElementById('result').innerText = 'Error initializing Google API client.';
                    });
                },
                onerror: function() {
                    console.error('Error loading Google API client library.');
                    document.getElementById('result').innerText = 'Error loading Google API client library.';
                },
                timeout: 5000, // 5 seconds.
                ontimeout: function() {
                    console.error('Google API client library load timeout.');
                    document.getElementById('result').innerText = 'Google API client library load timeout.';
                }
            });
        }

        function searchSheet() {
            const id = document.getElementById('idInput').value;

            gapi.client.sheets.spreadsheets.values.get({
                spreadsheetId: '1ai2njbt8pkT5zk-y82Ek14XqKkLDU_Sgx7eZA1xXQ7w',
                range: 'Sheet1!A:L', // Adjust the range as needed
            }).then(function(response) {
                const rows = response.result.values;
                let result = 'No match found';
                rows.forEach(row => {
                    if (row[0] == id) {
                        result = `ID: ${row[0]}, Name: ${row[1]}, Long Term Bal: ${row[2]}, Start: ${row[3]}, End: ${row[4]}, Guarantor: ${row[5]}, Short Term Bal: ${row[6]}, Start: ${row[7]}, End: ${row[8]}, Guarantor: ${row[9]}, Cutoff: ${row[11]}`;
                    }
                });
                document.getElementById('result').innerText = result;
            }).catch(function(error) {
                console.error('Error fetching data from Google Sheets:', error);
                document.getElementById('result').innerText = 'Error fetching data from Google Sheets.';
            });
        }

        window.onload = loadGapi;
    </script>
</head>
<body>
    <h1>Google Sheets Data Fetcher</h1>
    <input type="text" id="idInput" placeholder="Enter ID">
    <button id="searchButton">Search</button>
    <p id="result"></p>
</body>
</html>
